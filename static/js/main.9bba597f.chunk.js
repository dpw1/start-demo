(this.webpackJsonpbasic=this.webpackJsonpbasic||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),r=n(11),o=n.n(r),a=(n(44),n(2)),i=(n(45),n(13)),u=n(3),l=n.n(u),d=n(5),p=n(19),f=n.n(p),b=n(21),h=n.n(b),g=n(15),j={isEnabled:!0};function x(e){console.log("within sanitze: ",e);var t,n=e.items.filter((function(e){return e.relatedProducts.productIds.length>=1||e.relatedProducts.relatedCategory.enabled})),s=function(e){return e.hasOwnProperty("options")?e.options.length:e.hasOwnProperty("totalOptions")?e.totalOptions:0},c=[],r=Object(g.a)(n);try{for(r.s();!(t=r.n()).done;){var o,a=t.value,i=a.id,u=[],l=Object(g.a)(a.relatedProducts.productIds);try{for(l.s();!(o=l.n()).done;){var d=o.value,p=e.items.filter((function(e){return e.id===d}))[0];console.log(d),u.push({id:p.id,name:p.name,thumbnailUrl:p.thumbnailUrl,defaultDisplayedPriceFormatted:p.defaultDisplayedPriceFormatted,compareToPriceDiscountFormatted:p.compareToPriceDiscountFormatted,compareToPriceFormatted:p.compareToPriceFormatted,url:p.url,totalOptions:s(p)})}}catch(f){l.e(f)}finally{l.f()}a.relatedProducts.relatedCategory.enabled,c.push({id:i,bundle:u})}}catch(f){r.e(f)}finally{r.f()}return console.log("cleaning: ",c),c}var m=n(20),w=/localhost/.test(window.location.href)?"https://app.ecwid.com/api/v3/37374877/products?token=".concat("secret_EkQGe8SC4V4DHgSrnkmXsQsneDQ9JwQ4"):"https://app.ecwid.com/api/v3/".concat(window.EcwidApp.getPayload().store_id,"/products?token=").concat(window.EcwidApp.getPayload().access_token),O=f()(Object(m.subscribeWithSelector)((function(e,t){return{settings:j,products:[],visibleProducts:[],popupVisibleProducts:[],activeFilters:[],populateProducts:function(){var t=Object(d.a)(l.a.mark((function t(){var n,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=w,t.next=3,h.a.get(n);case 3:s=t.sent,c=s.data,window.store__products=c,e({products:c,visibleProducts:c});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),updateVisibleProducts:function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({visibleProducts:n});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updatePopupVisibleProducts:function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({popupVisibleProducts:n});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getProductById:function(e){return t().products.items.filter((function(t){return t.id===parseInt(e)}))[0]},upsellProducts:function(){var t=Object(d.a)(l.a.mark((function t(){var n,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=w,t.next=3,h.a.get(n);case 3:if(s=t.sent,c=s.data,console.log(x(c)),!window.EcwidApp||!window.EcwidApp.getPayload()){t.next=9;break}return t.abrupt("return",new Promise(function(){var t=Object(d.a)(l.a.mark((function t(n,s){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("before: ",window.upsellProducts),!window.hasOwnProperty("upsellProducts")){t.next=6;break}return n(window.upsellProducts),t.abrupt("return");case 6:console.log("upsell prods not found",window.upsellProducts),c=[],window.EcwidApp.getAppPublicConfig((function(t){var s=JSON.parse(t);if(!(c=c=s.upsellProducts))return window.upsellProducts=[],void n([]);console.log("xxx 33ECWID DB DATA",s,c,window.upsellProducts),window.upsellProducts=c,n(c),e({upsellProducts:c})}));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 9:return t.abrupt("return",[]);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),setStoreUpsellProducts:function(t){console.log("data: ",t),e({upsellProducts:t})},addUpsellProduct:function(){var n=Object(d.a)(l.a.mark((function n(s,c){var r,o,a,u,d,p,f,b,h,g,j,m,w;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("function"!==typeof t().upsellProducts){n.next=6;break}return n.next=3,t().upsellProducts();case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,t().upsellProducts;case 8:n.t0=n.sent;case 9:if(o=n.t0,a=o.length>=1&&o.filter((function(e){return e.id===s})),u=a.length>=1?a[0]:null,d=t().getProductById(s),p=t().getProductById(c),u&&(f=function(){var e=u.bundle;return Symbol.iterator in Object(e)?Object(i.a)(e):[e]},r=[].concat(Object(i.a)(f()),[p]),o=o.filter((function(e){return e.id!==s})),console.log(o)),b={id:s,bundle:r&&r.length>=1?Object(i.a)(new Set(r)):[d,p]},h=Symbol.iterator in Object(o)?Object(i.a)(o):[],g=[].concat(Object(i.a)(h),[b]),j=x(g),console.log("updated -- ",j),!window.EcwidApp){n.next=25;break}return n.next=23,t().settings;case 23:m=n.sent;try{w=JSON.stringify({settings:m,upsellProducts:j}),console.log("payload: ",{upsellProducts:j}),window.EcwidApp.setAppPublicConfig(w,(function(){console.log("New upsell product saved!")}))}catch(l){console.error("Couldn't save upsell product. [store.js - addUpsellProduct()]")}case 25:console.log("updated: ",j),e({upsellProducts:j});case 27:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),getUpsellProductById:function(){var e=Object(d.a)(l.a.mark((function e(n){var s,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t().upsellProducts){e.next=6;break}return e.next=3,t().upsellProducts();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,t().upsellProducts;case 8:e.t0=e.sent;case 9:return s=e.t0,c=s.filter((function(e){return e.id===n})),r=c.length>=1?c[0].bundle:[],console.log("Bundle products:",c,s,n,r),e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteUpsellProductById:function(){var n=Object(d.a)(l.a.mark((function n(s,c){var r,o,a,i,u;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("function"!==typeof t().upsellProducts){n.next=6;break}return n.next=3,t().upsellProducts();case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,t().upsellProducts;case 8:n.t0=n.sent;case 9:if(r=n.t0,o=[],a=r.find((function(e){return e.id===s}))){n.next=15;break}return console.log("parent is undefined!!!"),n.abrupt("return");case 15:if(console.log("deleted bundle from parent: ",a,s,c),i=a.bundle.filter((function(e){return e.id!==c})),o=i.length<=1?r.filter((function(e){return e.id!==s})):r,a.bundle=i,console.log("Updated after delete: ",o),!window.EcwidApp){n.next=25;break}return n.next=23,t().settings;case 23:u=n.sent;try{window.EcwidApp.setAppPublicConfig(JSON.stringify({settings:u,upsellProducts:o}),(function(){console.log("Public config saved!")})),console.log("Saved upsell products in Database")}catch(l){}case 25:e({upsellProducts:o});case 26:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),setSettings:function(){var n=Object(d.a)(l.a.mark((function n(s){var c,r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s){n.next=2;break}throw new Error("no settings object");case 2:if("function"!==typeof t().upsellProducts){n.next=8;break}return n.next=5,t().upsellProducts();case 5:n.t0=n.sent,n.next=11;break;case 8:return n.next=10,t().upsellProducts;case 10:n.t0=n.sent;case 11:if(c=n.t0,window.EcwidApp)try{r={settings:s,upsellProducts:c},window.EcwidApp.setAppPublicConfig(JSON.stringify(r),(function(e){console.log("Public config saved. Payload: ",r)})),console.log("Saved settings in Database")}catch(o){}e({settings:s});case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),setActiveFilters:function(){var t=Object(d.a)(l.a.mark((function t(){var n,s=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=s.length>0&&void 0!==s[0]?s[0]:null){t.next=3;break}return t.abrupt("return");case 3:console.log(n),e({activeFilters:n});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getCurrentPopupProduct:void 0,setCurrentPopupProduct:function(t){e({getCurrentPopupProduct:t})}}}))),v=(n(66),n(0));n(36),n(17),n(68);n(69),n(70);n(71);n(6),n(72),n(76);n(77),n(37),n(94);n(39),n(104);n(105);function P(){var e=O((function(e){return e.setSettings})),t=Object(s.useState)(!1),n=Object(a.a)(t,2),c=n[0],r=n[1],o=Object(s.useState)("Complete your purchase"),i=Object(a.a)(o,2),u=i[0],l=i[1],d=O((function(e){return e.settings}));return Object(s.useEffect)((function(){r(d.isEnabled)}),[d]),Object(v.jsxs)("div",{className:"HomepageSettings",children:[Object(v.jsxs)("div",{className:"HomepageSettings-item HomepageSettings-item--checkbox form-area__content form-area__content--no-margin",children:[Object(v.jsxs)("div",{className:"HomepageSettings-description",children:[Object(v.jsx)("p",{className:"HomepageSettings-text",children:"Show on checkout page"}),Object(v.jsx)("p",{className:"HomepageSettings-subtitle",children:c?"The app is enabled on the storefront.":Object(v.jsxs)("span",{children:["The app is ",Object(v.jsx)("b",{children:"not"})," enabled on the storefront. It will not show up on the checkout page."]})})]}),Object(v.jsx)("div",{className:"HomepageSettings-setting text-default",children:Object(v.jsxs)("label",{className:"checkbox micro",children:[Object(v.jsx)("input",{name:"",checked:c,onChange:function(){r(!c),e({isEnabled:!c})},type:"checkbox"})," ",Object(v.jsxs)("div",{className:"HomepageSettings-text","data-on":"App is enabled on the storefront","data-off":"App is disabled",children:[" ",Object(v.jsx)("div",{})," "]})]})})," "]}),Object(v.jsxs)("div",{className:"HomepageSettings-item form-area__content form-area__content--no-margin",children:[Object(v.jsxs)("div",{className:"HomepageSettings-description",children:[Object(v.jsx)("p",{className:"HomepageSettings-text",children:"App's title"}),Object(v.jsx)("p",{className:"HomepageSettings-subtitle",children:"Text that is shown above the carousel on the checkout page."})]}),Object(v.jsx)("div",{className:"HomepageSettings-setting text-default",children:Object(v.jsxs)("div",{className:"HomepageSettings-field field",children:[Object(v.jsx)("input",{type:"text",className:"field__input",placeholder:"Carousel title",value:u,onChange:function(e){return l(e.target.value)}})," "]})})," "]})]})}n(106);function y(e){return Object(v.jsxs)("div",{className:"TextContentBlock",children:[Object(v.jsx)("h2",{className:"TextContentBlock-title",children:e.title}),Object(v.jsx)("p",{className:"TextContentBlock-description TextContentBlock-additional-description",children:e.additionalDescription}),Object(v.jsxs)("div",{className:"TextContentBlock-container",children:[Object(v.jsxs)("div",{className:"TextContentBlock-left",children:[Object(v.jsx)("h3",{className:"TextContentBlock-subtitle",children:e.subtitle}),Object(v.jsx)("p",{className:"TextContentBlock-description",children:e.description&&"function"===typeof e.description?e.description():e.description})]}),Object(v.jsx)("div",{className:"TextContentBlock-right",children:e.children})]})]})}n(107);var k=n.p+"static/media/example-1.2dbf34c7.png";function N(){return Object(v.jsx)("div",{className:"Tutorial",children:Object(v.jsxs)("div",{className:"Tutorial-container",children:[Object(v.jsxs)("div",{className:"Tutorial-left",children:[Object(v.jsx)("p",{className:"HomepageSettings-text Text--h3",children:"Offer products at the checkout page"}),Object(v.jsx)("div",{className:"Text--p",children:"This app creates a carousel with recommendations based on what your customer has added to the cart."}),Object(v.jsx)("br",{}),Object(v.jsx)("div",{className:"Text--p",children:"These recommendations are configured manually. To configure it, please do the following:"}),Object(v.jsxs)("ol",{children:[Object(v.jsx)("li",{className:"Text--p",children:"Choose one of your products from the list below in the next section."}),Object(v.jsx)("li",{className:"Text--p",children:'Once you\'ve found it, click on "Add Upsell Products." A popup will appear.'}),Object(v.jsx)("li",{className:"Text--p",children:"In this popup, choose the products you'd like to display on the carousel."})]})]}),Object(v.jsx)("figure",{className:"Tutorial-figure",children:Object(v.jsx)("img",{src:k,alt:""})})]})})}var S=function(){var e=Object(s.useState)(null),t=Object(a.a)(e,2),n=(t[0],t[1]),c=Object(s.useState)(null),r=Object(a.a)(c,2),o=(r[0],r[1]),i=Object(s.useState)(!1),u=Object(a.a)(i,2),l=u[0],d=u[1],p=(O((function(e){return e.settings})),O((function(e){return e.setSettings})));function f(e){e=JSON.parse(e);var t={upsellProducts:[]};try{t.settings=e.hasOwnProperty("settings")?e.settings:[]}catch(n){t.settings=[]}console.log("!Must create new database? ",false,t),console.log("vaue",e),o(t.upsellProducts),p(t.settings),d(!0)}return O((function(e){return e.upsellProducts})),Object(s.useEffect)((function(){var e=window.EcwidApp.getPayload();n(e),O.subscribe((function(e){return e.upsellProducts}),(function(e){console.log("upsell products update from app!",e)})),O.subscribe((function(e){return e.settings}),(function(e){console.log("settings update from app!",e)})),window.EcwidApp.getPayload()||f(JSON.stringify({upsellProducts:[],settings:j})),window.EcwidApp&&window.EcwidApp.getPayload()&&!l&&window.EcwidApp.getAppPublicConfig((function(e){console.log("has init?",l,e),f(e)}))}),[]),Object(v.jsx)("div",{className:"EasyUpsellApp",children:Object(v.jsx)("div",{className:"EasyUpsellApp-container",children:Object(v.jsx)("div",{className:"named-area",children:Object(v.jsx)("div",{className:"named-area__body",children:Object(v.jsx)("div",{className:"a-card a-card--compact",children:Object(v.jsxs)("div",{className:"EasyUpsellApp-block a-card__paddings",children:[Object(v.jsx)(y,{title:"Checkout Upsell",subtitle:"Summary",additionalDescription:"Show a carousel with products related to what your customer has added to cart on the checkout page.",description:"Brief explanation on how to get started.",children:Object(v.jsx)(N,{})}),Object(v.jsx)(y,{subtitle:"App settings",description:"Configure the app settings here.",children:Object(v.jsx)(P,{})})]})})})})})})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,111)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),s(e),c(e),r(e),o(e)}))};o.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(S,{})}),document.getElementById("root")),A()},44:function(e,t,n){},45:function(e,t,n){},66:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},94:function(e,t,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.9bba597f.chunk.js.map